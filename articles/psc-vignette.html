<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>psc-vignette • psc</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="psc-vignette">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">psc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/psc.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/psc-vignette.html">psc-vignette</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/richJJackson/psc/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>psc-vignette</h1>
                        <h4 data-toc-skip class="author">Richard
Jackson</h4>
            
            <h4 data-toc-skip class="date">2025-07-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/richJJackson/psc/blob/main/vignettes/psc-vignette.Rmd" class="external-link"><code>vignettes/psc-vignette.Rmd</code></a></small>
      <div class="d-none name"><code>psc-vignette.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The psc.R package implements the methods for applying Personalised
Synthetic Controls, which allows for patients receiving some
experimental treatment to be compared against a model which predicts
their reponse to some control. This is a form of causal inference which
differes from other approaches in that</p>
Data are only required on a single treatment - all counterfactual
evidence is supplied by a parametric model
<p>Causal inference, in theory at least, is estimated at a patient level
- as opposed to estimating average effects over a population</p>
<p>The causal estimand obtained is the Average Treatment Effect of the
Treated (ATT) which differs from the Average Treatment Effect (ATE)
obtained in other settings and addresses the question of whether
treatments are effective in the population of patients who are treated.
This estimand then targets efficacy over effectivness.</p>
<p>In its basic form, this method creates a likelihood to compare a
cohort of data to a parametric model. See (X) for disucssion on it’s use
as a causal inference tool. To use this package, two basic peices of
information are required, a dataset and a model against which they can
be compared.</p>
<p>In this vignette, we will detail how the psc.r package is constructed
and give some examples for it’s application in practice.</p>
</div>
<div class="section level2">
<h2 id="methodology">Methodology<a class="anchor" aria-label="anchor" href="#methodology"></a>
</h2>
<p>The <code>pscfit</code> function compares a dataset (‘DC’) against a
parametric model. This is done by selecting a likelihood which is
identified by the type of CFM that is supplied. At present, two types of
model are supported, a flexible parmaeteric survival model of type
‘flexsurvreg’ and a geleneralised linear model of type ‘glm’.</p>
<p>Where the CFM is of type ‘flexsurvreg’ the likeihood supplied is of
the form:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>D</mi><mo>∣</mo><mi>Λ</mi><mo>,</mo><msub><mi>Γ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>f</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo>∣</mo><mi>Λ</mi><mo>,</mo><msub><mi>Γ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>c</mi><mi>i</mi></msub></msup><mi>S</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo>∣</mo><mi>Γ</mi><mo>,</mo><msub><mi>Λ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">L(D∣\Lambda,\Gamma_i)=\prod_{i=1}^{n} f(t_i∣\Lambda,\Gamma_i)^{c_i} 
S(t_i∣\Gamma,\Lambda_i)^{(1−c_i)}</annotation></semantics></math></p>
<p>Where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Γ</mi><annotation encoding="application/x-tex">\Gamma</annotation></semantics></math>
defines the cumulative baseline hazard function,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Λ</mi><annotation encoding="application/x-tex">\Lambda</annotation></semantics></math>
is the linear predictor and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>
are the event time and indicator variables.</p>
<p>Where the CFM is of the type ‘glm’ the likelihood supplied is of the
form:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>∣</mo><msub><mi>Γ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>∣</mo><msub><mi>Γ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>exp</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>Γ</mi><mi>i</mi></msub><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Γ</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">L(x∣\Gamma_i) = \prod_{i=1}^{n} b (x∣ \Gamma_i )\exp\{\Gamma_i t(x)−
c(\Gamma_i)\}</annotation></semantics></math></p>
<p>Where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>.</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">b(.)</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>.</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">t(.)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>.</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">c(.)</annotation></semantics></math>
represent the functions of the exponential family. In both cases,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Γ</mi><annotation encoding="application/x-tex">\Gamma</annotation></semantics></math>
is defiend as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Γ</mi><mi>i</mi></msub><mo>=</mo><mi>γ</mi><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi>β</mi></mrow><annotation encoding="application/x-tex"> \Gamma_i = \gamma x_i+\beta </annotation></semantics></math></p>
<p>Where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>γ</mi><annotation encoding="application/x-tex">\gamma</annotation></semantics></math>
are the model coefficients supplied by the CFM and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
is the parameter set to measure the difference between the CFM and the
DC.</p>
<p>Estimation is performed using a Bayesian MCMC procedure. Prior
distributions for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Γ</mi><annotation encoding="application/x-tex">\Gamma</annotation></semantics></math>
(&amp;
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Λ</mi><annotation encoding="application/x-tex">\Lambda</annotation></semantics></math>)
are derived directly from the model coefficients (mean and variance
covariance matrix) or the CFM. A bespoke MCMC routine is performed to
estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>.
Please see ‘?mcmc’ for more detials.</p>
<p>For the standard example where the DC contains information from only
a single treatment, trt need not be specified. Where comparisons between
the CFM and multiple treatments are require, a covariate of treamtne
allocations must be specified sperately (using the ‘trt’ option).</p>
</div>
<div class="section level2">
<h2 id="package-structure">Package Structure<a class="anchor" aria-label="anchor" href="#package-structure"></a>
</h2>
<p>The main function for using applying Personal Synthetic Controls is
the pscfit() function which has two inputs, a Counter-Factual Model
(CFM) and a data cohort (DC). Further arguments include</p>
<ul>
<li>nsim which sets the number of MCMC iterations (defaults to
5000)</li>
<li>‘id’ if the user wishes to restrict estimation to a sub-set (or
individual) within the DC</li>
<li>‘trt’ to be used as an initial identifier if mulitple treatment
comparisons are to be made (please see the Mulitple Treatment Comparison
below)</li>
</ul>
<div class="section level3">
<h3 id="psc-object">psc object<a class="anchor" aria-label="anchor" href="#psc-object"></a>
</h3>
<p>The output of the “pscfit()” function is an object of class ‘psc’.
This class contains the following attributes</p>
<ul>
<li>A definition of the calss of the model supplied</li>
<li>A ‘cleaned’ dataset including extracted components of the CFM and
the cleaned DC included in the procedure</li>
<li>An object defingin the class of model (and therefore the procedure
applied - see above)</li>
<li>A matrix containing the draws of the posterior distributions</li>
</ul>
</div>
<div class="section level3">
<h3 id="postestimation-functions">Postestimation functions<a class="anchor" aria-label="anchor" href="#postestimation-functions"></a>
</h3>
<p>basic post estimation functions have been developed to work with the
psc object, namely “print()”, “coef()”, “summary()” and “plot()”. For
the first three of these these provided basic summaries of the efficacy
parameter obtained from the posterior distribution.</p>
</div>
</div>
<div class="section level2">
<h2 id="motivating-example">Motivating Example<a class="anchor" aria-label="anchor" href="#motivating-example"></a>
</h2>
<p>The psc.r package includes as example a dataset which is derived from
patients with pancreatic ductal adenocarcinoma (PDAC) who have all
received some experimental treatment, in this case GemCap. The dataset
is named ‘e4_data’ and is loaded into the enviroment using the “data()”
function</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#install.packages("psc")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/richjjackson/psc/" class="external-link">psc</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/" class="external-link">ggpubr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: ggplot2</span></span>
<span><span class="va">e4_data</span> <span class="op">&lt;-</span> <span class="fu">psc</span><span class="fu">::</span><span class="va"><a href="../reference/e4_data.html">e4_data</a></span></span></code></pre></div>
<p>Included is a list of prognostic covariates:</p>
<ul>
<li>nodes: patient lymph node status; negative (n=1) or positive (n=2)
lymph nodes</li>
<li>grade: tumour grade; 1,2 or 3</li>
<li>lca199: log transformed ca19.9</li>
<li>t: T-stage; (1,2 or 3)</li>
</ul>
<p>Also included are the following structures</p>
<ul>
<li>time - survival time</li>
<li>cen - censoring indictor</li>
</ul>
<p>We give esamples of how the ‘pscfit()’ function can be used to
comapre data against models with survival outcomes (with a ‘flexsurvreg’
model). Examples on how to perform analyses using GLM model objects are
available from the github repo <a href="https://github.com/richJJackson/psc" class="external-link uri">https://github.com/richJJackson/psc</a></p>
<div class="section level3">
<h3 id="survival-example">Survival Example<a class="anchor" aria-label="anchor" href="#survival-example"></a>
</h3>
<p>For an example with a survival outcome a model must be supplied which
is contructed ont he basis of flexible parametric splines. This is
contructed using the “flexsurvreg” function within the “flexsurv”
package. An example is included within the ‘psc.r’ package names
‘surv.mod’ and is loaded using the ’data()” function:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#emCFM &lt;- psc::gemCFM</span></span></code></pre></div>
<p>The ‘gemCFM’ is an object of calss pscCFM which means it contains all
of the structures required for analysis but has stripped the model
object of any patient level data. Included instead are a summary
table:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gemCFM</span><span class="op">$</span><span class="va">datasumm</span></span>
<span><span class="co">#&gt; A Summary Table[1] "summ_Table"</span></span></code></pre></div>
<p>…and a set of visualisations which we arrange using the ggarrange</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggarrange</a></span><span class="op">(</span>plotlist<span class="op">=</span><span class="va">gemCFM</span><span class="op">$</span><span class="va">datavis</span><span class="op">)</span></span></code></pre></div>
<p><img src="psc-vignette_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<p>In this example you can see that this is a model constructed with 3
internal knots and hence 5 parameters to describe the baseline
cumulative hazard function. There are also prognostic covariates which
match with the prognostic covariates in the data cohort.</p>
<p>Comparing the dataset to the model is then performed using</p>
<p>and we can view the attributes of the psc object that is created</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">surv.psc</span><span class="op">)</span></span>
<span><span class="co">#&gt; $names</span></span>
<span><span class="co">#&gt; [1] "model.type" "DC_clean"   "posterior" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $class</span></span>
<span><span class="co">#&gt; [1] "psc"</span></span></code></pre></div>
<p>For example to view the matrix contianing the draws of the posterior
distribution we use</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">surv.post</span> <span class="op">&lt;-</span> <span class="va">surv.psc</span><span class="op">$</span><span class="va">posterior</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">surv.post</span><span class="op">)</span></span>
<span><span class="co">#&gt;       gamma0   gamma1      gamma2     gamma3      gamma4        t3        t4</span></span>
<span><span class="co">#&gt; 1 -10.183475 2.886891  0.32844796 -0.5849253  0.55252918 0.5605011 0.4197932</span></span>
<span><span class="co">#&gt; 2 -10.374219 2.921543  0.35192056 -0.6365481  0.58544703 0.3962898 0.2498031</span></span>
<span><span class="co">#&gt; 3 -10.965218 2.788057 -0.06478021 -0.1637076  0.50457712 0.8416433 0.6618134</span></span>
<span><span class="co">#&gt; 4 -10.837710 3.478723  1.00099147 -1.8249162  1.28273268 0.3830648 0.3742471</span></span>
<span><span class="co">#&gt; 5 -10.186945 2.932136 -0.26218258  0.5825346 -0.09242458 0.1376766 0.2445612</span></span>
<span><span class="co">#&gt; 6  -9.347187 2.542036  0.30628179 -0.5125706  0.45910993 0.8832303 0.7760956</span></span>
<span><span class="co">#&gt;      grade2    grade3    nodes2     lca199       beta      DIC</span></span>
<span><span class="co">#&gt; 1 0.4117679 0.7335891 0.4861837 0.20571716 -0.2429918       NA</span></span>
<span><span class="co">#&gt; 2 0.5187969 0.9038129 0.7217757 0.20592879 -0.1972145 839.3385</span></span>
<span><span class="co">#&gt; 3 0.2646033 0.7761573 0.7368542 0.24363784 -0.1991925 849.5411</span></span>
<span><span class="co">#&gt; 4 0.1709291 0.4459290 0.3303669 0.18685758 -0.1991925 846.2865</span></span>
<span><span class="co">#&gt; 5 0.2749036 0.4610892 0.3754181 0.25901970 -0.1991925 842.9351</span></span>
<span><span class="co">#&gt; 6 0.4475706 1.1129677 0.6109946 0.08936575 -0.1467539 856.0669</span></span></code></pre></div>
<p>Inspection will show that there is a column for each parameter in the
original model as well as ‘beta’ and ‘DIC’ vcolumns which give teh
posterior estiamtes for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
and the Deviance Informaiton Criterion respectively.</p>
<p>We can inspect the poterior distribution using the autocorrelation
function, trace and stardard summary statistics:</p>
<div class="section level5">
<h5 id="autocorrelation">Autocorrelation<a class="anchor" aria-label="anchor" href="#autocorrelation"></a>
</h5>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html" class="external-link">acf</a></span><span class="op">(</span><span class="va">surv.post</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span></span></code></pre></div>
<p><img src="psc-vignette_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
</div>
<div class="section level5">
<h5 id="trace">Trace<a class="anchor" aria-label="anchor" href="#trace"></a>
</h5>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">surv.post</span><span class="op">$</span><span class="va">beta</span>,typ<span class="op">=</span><span class="st">"s"</span><span class="op">)</span></span></code></pre></div>
<p><img src="psc-vignette_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
</div>
<div class="section level5">
<h5 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h5>
<p>Standard ‘summary()’ function wil summarise the model fit</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">surv.psc</span><span class="op">)</span></span>
<span><span class="co">#&gt; Summary: </span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; 311 observations selected from the data cohort for comparison </span></span>
<span><span class="co">#&gt; CFM of type flexsurvreg identified  </span></span>
<span><span class="co">#&gt; linear predictor succesfully obtained with median: </span></span>
<span><span class="co">#&gt;  trt: 1.786</span></span>
<span><span class="co">#&gt; Average expected response: </span></span>
<span><span class="co">#&gt;  trt: 30.077</span></span>
<span><span class="co">#&gt; Average observed response: 26.327 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Counterfactual Model (CFM): </span></span>
<span><span class="co">#&gt; A model of class 'flexsurvreg' </span></span>
<span><span class="co">#&gt;  Fit with 3 internal knots</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula: </span></span>
<span><span class="co">#&gt; s.ob ~ t + grade + nodes + lca199</span></span>
<span><span class="co">#&gt; &lt;environment: 0x55dca2c836d8&gt;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt;  CFM model + beta</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;       median     2.5%       97.5%      Pr(x&lt;0)    Pr(x&gt;0)  </span></span>
<span><span class="co">#&gt; beta   -0.25020   -0.44084   -0.06284    0.99520    0.00480</span></span>
<span><span class="co">#&gt; DIC   844.64311  837.88243  857.62927         NA         NA</span></span></code></pre></div>
<p>To visualise the original model and the fit of the data, the plot
function has been developed</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">surv.psc</span><span class="op">)</span></span></code></pre></div>
<p><img src="psc-vignette_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Richard Jackson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
